<html>
<head>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-MfvZlkHCEqatNoGiOXveE8FIwMzZg4W85qfrfIFBfYc= sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">

    <script src='https://code.jquery.com/jquery-1.11.3.min.js'></script>
    <script src='dist/purecloud-api.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.2.0/mustache.min.js'></script>

    <script>
        var lastData = null;
        var pureCloudSession = new PureCloudSession();
        var usersapi = new UsersApi(pureCloudSession);

        function getUsers(page){
            usersapi.get(10,page).done(generateTemplate).error(function(data){
                console.log(data);
            });
        }

        function nextPage(){
            pureCloudSession.get(lastData.nextUri).done(generateTemplate);
        }

        function previousPage(){
            pureCloudSession.get(lastData.previousUri).done(generateTemplate);
        }

        function generateTemplate(data){
            lastData = data;
            var template = $('#personTpl').html();
            var html = Mustache.to_html(template, data);
            $('#generated').html(html);
        }

        var redirectUrl = "http://localhost:8085/authredirect.html";

        if(window.location.hostname === 'mypurecloud.github.io'){
            redirectUrl = "http://mypurecloud.github.io/purecloud_javascript_client/examples/authredirect.html";
        }

        pureCloudSession.authorize('efb6698a-5f76-4f90-bf29-9a69a3555602', redirectUrl, "user_paging").done(function(){
            getUsers(1);
        });

    </script>
</head>

<body>
    <script id="personTpl" type="text/template">
        Total: {{total}}
        <button  class="btn btn-default" onclick="nextPage()">
            Next Page
        </button>
        <button  class="btn btn-default" onclick="previousPage()">
            Previous Page
        </button>

    <table  class="table table-striped">
        <tr>
            <th>Name</th>
            <th>Title</th>
        </tr>
    {{#entities}}
    <tr>
        <td>{{displayName}}</td>
        <td>{{title}}</td>
    </tr>
    {{/entities}}
</table>
    </script>
    <div id='generated'>
    </div>
</body>
